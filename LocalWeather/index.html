<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js">
<!--<![endif]-->

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title></title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

</head>

<body>
    <dev id='coordinates'></dev>

</body>

</html>

<script>
// Function to get the browser's current Location.
    function getCurrentLocation() {
        var output = document.getElementById('coordinates');
        output.innerHTML = navigator.geolocation.getCurrentPosition(success,
            error);

        function error() {
            output.innerHTML = "Unable to retrieve your location";
        }

        function success(position) {
            var latitude = position.coords.latitude;
            var longitude = position.coords.longitude;
            getWeather(longitude, latitude);

        }
    }
// Function to get the weather from a specified Longitude and Latitude
    function getWeather(longitude, latitude) {
        var urlCall = 'https://maps.googleapis.com/maps/api/geocode/json?latlng=' + latitude + ',' + longitude +
            '&key=AIzaSyD29yaou7CURfjjUOdWuHp-Uw7zaByeS7Y';
        
        var city = '';
        function cityNameSetter(cityName){
            city = cityName;
        }

        $.getJSON(urlCall, function (response) {
            var arrayOfResults = [];
            $.each(response.results[0], function (key, val) {
                arrayOfResults.push(val);
            });
            cityNameSetter(arrayOfResults[0][3]['short_name']);
            
        }).done(function (){
             requestWeather(city);
        });     
    }
// Function to make the call to Yahoo!'s weather API, with a specified city String.
    function requestWeather(location) {
        var apiAdress = 'https://query.yahooapis.com/v1/public/yql?q=';
        var urlCall = apiAdress +
            'select * from weather.forecast where woeid in (select woeid from geo.places(1) where text=\"' + location +
            '")+&format=json';
        $.getJSON(urlCall, function (response) {
            var channel = response.query.results.channel;
            console.log(channel.description);


        })



    }

    getCurrentLocation();
</script>